<?xml version="1.0" encoding="utf-8" ?>
<UserControl
    x:Class="Dimmer.WinUI.Views.CustomViews.WinuiViews.SongStatsView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="using:Dimmer.WinUI.Views.CustomViews.WinuiViews"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:models="using:Dimmer.Data.ModelView"
    mc:Ignorable="d">

    <UserControl.Resources>
        <Style x:Key="StatCardStyle" TargetType="Border">
            <Setter Property="Background" Value="#252526" />
            <Setter Property="CornerRadius" Value="20" />
            <Setter Property="Margin" Value="10" />
            <Setter Property="Padding" Value="20" />
            <Setter Property="BorderBrush" Value="#333333" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Shadow">
                <Setter.Value>
                    <ThemeShadow />
                </Setter.Value>
            </Setter>
            <!--  Elevation  -->
        </Style>

        <Style x:Key="StatLabelStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#AAAAAA" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="FontWeight" Value="SemiBold" />
        </Style>

        <Style x:Key="StatValueStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="White" />
            <Setter Property="FontSize" Value="32" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="Margin" Value="0,5,0,0" />
        </Style>
    </UserControl.Resources>

    <Grid Padding="10">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!--  CARD 0: Total Dims  -->
        <Border
            Grid.Row="0"
            Grid.Column="0"
            Style="{StaticResource StatCardStyle}">
            <StackPanel VerticalAlignment="Center">
                <StackPanel Orientation="Horizontal" Spacing="10">
                    <FontIcon
                        FontFamily="Segoe MDL2 Assets"
                        Foreground="MediumSlateBlue"
                        Glyph="&#xE7F6;" />
                    <TextBlock Style="{StaticResource StatLabelStyle}" Text="Total Dimms" />
                </StackPanel>
                <TextBlock Style="{StaticResource StatValueStyle}" Text="{x:Bind ViewModel.SelectedSong.PlayCompletedCount, Mode=OneWay}" />
                <TextBlock
                    Margin="0,5,0,0"
                    FontSize="12"
                    Foreground="#666"
                    Text="{x:Bind ViewModel.SelectedSong.PlayCount, Mode=OneWay, Converter={StaticResource StringFormatConverter}, ConverterParameter='Total Events: {0}'}" />
            </StackPanel>
        </Border>

        <!--  CARD 1: Completion Rate  -->
        <Border
            Grid.Row="0"
            Grid.Column="1"
            Style="{StaticResource StatCardStyle}">
            <Grid>
                <StackPanel VerticalAlignment="Center">
                    <StackPanel Orientation="Horizontal" Spacing="10">
                        <FontIcon
                            FontFamily="Segoe MDL2 Assets"
                            Foreground="LightGreen"
                            Glyph="&#xE9D9;" />
                        <TextBlock Style="{StaticResource StatLabelStyle}" Text="Completion Rate" />
                    </StackPanel>
                    <TextBlock Style="{StaticResource StatValueStyle}" Text="{x:Bind ViewModel.SelectedSong.ListenThroughRate, Mode=OneWay, Converter={StaticResource StringFormatConverter}}" />

                    <ProgressBar
                        Height="4"
                        Margin="0,10,0,0"
                        Foreground="MediumSlateBlue"
                        Maximum="1"
                        Value="{x:Bind ViewModel.SelectedSong.ListenThroughRate, Mode=OneWay}" />
                </StackPanel>
            </Grid>
        </Border>

        <!--  CARD 2: Advanced Metrics  -->
        <Border
            Grid.Row="1"
            Grid.Column="0"
            Style="{StaticResource StatCardStyle}">
            <StackPanel VerticalAlignment="Center" Spacing="5">
                <TextBlock
                    Opacity="0.5"
                    Style="{StaticResource StatLabelStyle}"
                    Text="METRICS" />

                <Grid Margin="0,10,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0">
                        <TextBlock
                            FontSize="12"
                            Foreground="#888"
                            Text="Eddington" />
                        <TextBlock
                            FontSize="24"
                            FontWeight="Bold"
                            Text="{x:Bind ViewModel.SelectedSong.EddingtonNumber, Mode=OneWay}" />
                    </StackPanel>

                    <StackPanel Grid.Column="1">
                        <TextBlock
                            FontSize="12"
                            Foreground="#888"
                            Text="Engagement" />
                        <TextBlock
                            FontSize="24"
                            FontWeight="Bold"
                            Text="{x:Bind ViewModel.SelectedSong.EngagementScore, Mode=OneWay, Converter={StaticResource StringFormatConverter}}" />
                    </StackPanel>
                </Grid>
            </StackPanel>
        </Border>

        <!--  CARD 3: Activity Log  -->
        <Border
            Grid.Row="1"
            Grid.Column="1"
            Style="{StaticResource StatCardStyle}">
            <StackPanel VerticalAlignment="Center" Spacing="8">
                <StackPanel Orientation="Horizontal" Spacing="10">
                    <FontIcon
                        FontFamily="Segoe MDL2 Assets"
                        Foreground="OrangeRed"
                        Glyph="&#xE787;" />
                    <TextBlock Style="{StaticResource StatLabelStyle}" Text="Activity" />
                </StackPanel>

                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition />
                    </Grid.RowDefinitions>

                    <TextBlock
                        Margin="0,0,10,0"
                        Foreground="#666"
                        Text="Last Played:" />
                    <TextBlock
                        Grid.Column="1"
                        Foreground="White"
                        Text="{x:Bind ViewModel.SelectedSong.LastPlayed, Mode=OneWay, Converter={StaticResource DateConverter}}" />

                    <TextBlock
                        Grid.Row="1"
                        Margin="0,5,10,0"
                        Foreground="#666"
                        Text="Play Streak:" />
                    <TextBlock
                        Grid.Row="1"
                        Grid.Column="1"
                        Margin="0,5,0,0"
                        Foreground="White"
                        Text="{x:Bind ViewModel.SelectedSong.PlayStreakDays, Mode=OneWay, Converter={StaticResource StringFormatConverter}}" />
                </Grid>
            </StackPanel>
        </Border>

    </Grid>
</UserControl>