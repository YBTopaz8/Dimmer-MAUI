<?xml version="1.0" encoding="utf-8" ?>
<UserControl
    x:Class="Dimmer.WinUI.Views.CustomViews.WinuiViews.MediaPlaybackSection"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converters="using:Dimmer.WinUI.Utils.Converters"
    xmlns:convertersWinUI="using:Dimmer.WinUI.Utils.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="using:Dimmer.WinUI.Views.CustomViews.WinuiViews"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">
    <Grid>
        <Grid.Resources>
            <ResourceDictionary>
                <convertersWinUI:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
                <convertersWinUI:IsNullToVisibilityConverter x:Key="IsNullToVisibilityConverter" />
                <convertersWinUI:RepeatModeConverter x:Key="RepeatModeConverter" />
                <convertersWinUI:BoolToInverseVisibilityConverter x:Key="BoolToInverseVisibilityConverter" />
                <convertersWinUI:BoolToPlayingPauseConv x:Key="BoolToPlayingPauseConverter" />
            </ResourceDictionary>
        </Grid.Resources>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto" />
            <RowDefinition Height="auto" />
        </Grid.RowDefinitions>
        <Grid Grid.Row="0">

            <StackPanel x:Name="TopPanel" Background="Transparent">
                <Grid Padding="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <!--<Image
                        x:Name="currentSongCoverImage"
                        Width="150"
                        Height="150"
                        Stretch="UniformToFill">
                        <Image.Source>
                            <BitmapImage UriSource="{x:Bind MyViewModel.CurrentCoverImagePath,Converter={StaticResource nul}, Mode=OneWay}" />
                        </Image.Source>
                    </Image>-->

                    <StackPanel Grid.Column="1" Spacing="5">
                        <StackPanel
                            VerticalAlignment="Center"
                            Orientation="Horizontal"
                            Spacing="5">


                            <TextBlock
                                VerticalAlignment="Center"
                                FontSize="22"
                                Text="{x:Bind MyViewModel.CurrentTrackPositionSeconds, Converter={StaticResource DurationConverter}, Mode=OneWay}" />
                            <TextBlock
                                VerticalAlignment="Center"
                                FontSize="22"
                                Text="/" />

                            <TextBlock
                                VerticalAlignment="Center"
                                FontSize="22"
                                Text="{x:Bind MyViewModel.CurrentTrackDurationSeconds, Converter={StaticResource DurationConverter}, Mode=OneWay}" />


                            <StackPanel
                                x:Name="TopPanelTwo"
                                Margin="0,0,0,0"
                                HorizontalAlignment="Left"
                                Orientation="Horizontal"
                                Spacing="10">
                                <ToggleButton Command="{x:Bind MyViewModel.ToggleShuffleCommand}" IsChecked="{x:Bind MyViewModel.IsShuffleActive, Mode=OneWay}">
                                    <SymbolIcon Symbol="Shuffle" />
                                </ToggleButton>
                                <Button
                                    x:Name="PrevBtn"
                                    AccessKey="B"
                                    Command="{x:Bind MyViewModel.PreviousTrackCommand}">
                                    <FontIcon Glyph="&#xE892;" />
                                </Button>
                                <ToggleButton
                                    x:Name="PlayBtn"
                                    AccessKey="P"
                                    Command="{x:Bind MyViewModel.PlayPauseToggleCommand}"
                                    Content="{x:Bind MyViewModel.IsDimmerPlaying, Converter={StaticResource BoolToPlayingPauseConverter}, Mode=OneWay}"
                                    IsChecked="{x:Bind MyViewModel.IsDimmerPlaying, Mode=OneWay}" />
                                <Button
                                    x:Name="NextBtn"
                                    AccessKey="N"
                                    AccessKeyDisplayRequested="NextBtn_AccessKeyDisplayRequested"
                                    AccessKeyInvoked="NextBtn_AccessKeyInvoked"
                                    Command="{x:Bind MyViewModel.NextTrackCommand}">
                                    <SymbolIcon Symbol="Next" />
                                </Button>

                                <Button Command="{x:Bind MyViewModel.ToggleRepeatModeCommand}" Content="{x:Bind MyViewModel.CurrentRepeatMode, Converter={StaticResource RepeatModeConverter}, Mode=OneWay}" />
                                <Button
                                    x:Name="HomeBtn"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    Click="HomeBtn_Click"
                                    CornerRadius="10"
                                    Visibility="Collapsed">
                                    <FontIcon FontSize="25" Glyph="&#xE80F;" />
                                </Button>



                            </StackPanel>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <Button
                                x:Name="ViewNowPlayingSong"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Background="Transparent"
                                BorderThickness="0.5"
                                Click="ViewNowPlayingSong_Click"
                                Content="{x:Bind MyViewModel.CurrentPlayingSongView.Title, Mode=OneWay}"
                                FontSize="24" />


                            <Button
                                x:Name="ArtistBtn"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Bottom"
                                Background="Transparent"
                                Content="{x:Bind MyViewModel.CurrentPlayingSongView.OtherArtistsName, Mode=OneWay}"
                                FontSize="24"
                                PointerPressed="ArtistBtn_PointerPressed" />

                            <Button
                                HorizontalAlignment="Center"
                                VerticalAlignment="Bottom"
                                Background="Transparent"
                                Content="{x:Bind MyViewModel.CurrentPlayingSongView.AlbumName, Mode=OneWay}"
                                FontSize="24" />



                            <Button
                                x:Name="ViewLyricsButton"
                                Background="Transparent"
                                Click="ViewLyricsButton_Click"
                                Visibility="{x:Bind MyViewModel.CurrentPlayingSongView.HasSyncedLyrics, Converter={StaticResource BoolToVisibilityConverter}, Mode=OneWay}">
                                <FontIcon
                                    Width="19"
                                    Height="19"
                                    Glyph="&#xEC71;" />
                            </Button>
                            
                            <Button
                                x:Name="CloudSyncButton"
                                Background="Transparent"
                                Click="CloudSyncButton_Click"
                                ToolTipService.ToolTip="Transfer session to another device">
                                <FontIcon
                                    Width="19"
                                    Height="19"
                                    Glyph="&#xE753;" />
                            </Button>
                        </StackPanel>


                    </StackPanel>
                </Grid>


            </StackPanel>
        </Grid>
        <StackPanel
            Grid.Row="0"
            Width="350"
            Margin="0,10,20,0"
            HorizontalAlignment="Right"
            VerticalAlignment="Top"
            Canvas.ZIndex="100">

            <InfoBar
                Title="{x:Bind MyViewModel.UnlockedAch.Name, Mode=OneWay}"
                IsClosable="True"
                IsIconVisible="True"
                IsOpen="{x:Bind MyViewModel.IsAchievementNotificationVisible, Mode=OneWay}"
                Message="{x:Bind MyViewModel.UnlockedAch.Description, Mode=OneWay}"
                Severity="Success">
                <!--  Add a Shadow for depth since it is floating  -->
                <InfoBar.Shadow>
                    <ThemeShadow />
                </InfoBar.Shadow>
                <!--  Add animation so it slides in nicely  -->
                <InfoBar.Transitions>
                    <TransitionCollection>
                        <EntranceThemeTransition FromVerticalOffset="-50" />
                    </TransitionCollection>
                </InfoBar.Transitions>
            </InfoBar>
            <InfoBar
                Title="Concerned Song"
                IsClosable="True"
                IsIconVisible="True"
                IsOpen="{x:Bind MyViewModel.IsAchievementNotificationVisible, Mode=OneWay}"
                Message="{x:Bind MyViewModel.AchievementSecondMessage, Mode=OneWay}"
                Severity="Success">
                <!--  Add a Shadow for depth since it is floating  -->
                <InfoBar.Shadow>
                    <ThemeShadow />
                </InfoBar.Shadow>
                <!--  Add animation so it slides in nicely  -->
                <InfoBar.Transitions>
                    <TransitionCollection>
                        <EntranceThemeTransition FromVerticalOffset="-50" />
                    </TransitionCollection>
                </InfoBar.Transitions>
            </InfoBar>

        </StackPanel>

    </Grid>
</UserControl>
