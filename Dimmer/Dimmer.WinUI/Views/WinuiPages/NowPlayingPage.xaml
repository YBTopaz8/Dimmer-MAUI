<?xml version="1.0" encoding="utf-8" ?>
<Page
    x:Class="Dimmer.WinUI.Views.WinuiPages.NowPlayingPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:converters="using:Dimmer.WinUI.Utils.Converters"
    mc:Ignorable="d">

    <Page.Resources>
        <converters:StringToImageSourceConverter x:Key="StringToImageSourceConverter" />
    </Page.Resources>

    <Grid x:Name="RootGrid">
        <!-- Background Image with Blur Effect -->
        <Grid.Background>
            <ImageBrush x:Name="BackgroundImageBrush" Stretch="UniformToFill" Opacity="0.3" />
        </Grid.Background>

        <!-- Dark overlay for better text readability -->
        <Border Background="#AA000000" />

        <!-- Main Content -->
        <Grid Margin="40,20,40,40">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <!-- Left Section: Cover Art and Metadata -->
            <StackPanel Grid.Column="0" Width="340" Spacing="20">
                <!-- Cover Art -->
                <Border
                    Width="300"
                    Height="300"
                    CornerRadius="12"
                    Background="#1F1F1F">
                    <Image
                        x:Name="CoverImage"
                        Stretch="UniformToFill" />
                </Border>

                <!-- Metadata Chips -->
                <StackPanel Spacing="12">
                    <!-- Artist Chip -->
                    <Border
                        Background="#2A2A2A"
                        CornerRadius="16"
                        Padding="16,10">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE77B;" FontSize="16" Foreground="#FFFFFF" />
                            <TextBlock
                                x:Name="ArtistTextBlock"
                                FontSize="14"
                                Foreground="#FFFFFF"
                                VerticalAlignment="Center"
                                TextWrapping="Wrap" />
                        </StackPanel>
                    </Border>

                    <!-- Genre Chip -->
                    <Border
                        Background="#2A2A2A"
                        CornerRadius="16"
                        Padding="16,10">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE8D6;" FontSize="16" Foreground="#FFFFFF" />
                            <TextBlock
                                x:Name="GenreTextBlock"
                                FontSize="14"
                                Foreground="#FFFFFF"
                                VerticalAlignment="Center"
                                TextWrapping="Wrap" />
                        </StackPanel>
                    </Border>

                    <!-- Year Chip -->
                    <Border
                        Background="#2A2A2A"
                        CornerRadius="16"
                        Padding="16,10">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE787;" FontSize="16" Foreground="#FFFFFF" />
                            <TextBlock
                                x:Name="YearTextBlock"
                                FontSize="14"
                                Foreground="#FFFFFF"
                                VerticalAlignment="Center" />
                        </StackPanel>
                    </Border>

                    <!-- Queue Chip -->
                    <Border
                        Background="#2A2A2A"
                        CornerRadius="16"
                        Padding="16,10"
                        PointerPressed="QueueChip_PointerPressed">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE90B;" FontSize="16" Foreground="#FFFFFF" />
                            <TextBlock
                                x:Name="QueueTextBlock"
                                FontSize="14"
                                Foreground="#FFFFFF"
                                VerticalAlignment="Center"
                                Text="View Queue" />
                        </StackPanel>
                    </Border>
                </StackPanel>
            </StackPanel>

            <!-- Right Section: Lyrics -->
            <Grid Grid.Column="1" Margin="40,0,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <!-- Song Title -->
                <TextBlock
                    x:Name="TitleTextBlock"
                    Grid.Row="0"
                    FontSize="28"
                    FontWeight="Bold"
                    Foreground="#FFFFFF"
                    TextWrapping="Wrap"
                    Margin="0,0,0,20" />

                <!-- Lyrics ScrollViewer -->
                <ScrollViewer
                    x:Name="LyricsScrollViewer"
                    Grid.Row="1"
                    VerticalScrollBarVisibility="Auto"
                    HorizontalScrollBarVisibility="Disabled">
                    <StackPanel x:Name="LyricsContainer" Spacing="16" />
                </ScrollViewer>

                <!-- No Lyrics Placeholder -->
                <StackPanel
                    x:Name="NoLyricsPanel"
                    Grid.Row="1"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Spacing="20"
                    Visibility="Collapsed">
                    <FontIcon
                        Glyph="&#xE8D3;"
                        FontSize="64"
                        Foreground="#808080" />
                    <TextBlock
                        Text="No lyrics available for this song"
                        FontSize="18"
                        Foreground="#CCCCCC"
                        HorizontalAlignment="Center" />
                    <Button
                        Content="Search or Add Lyrics"
                        HorizontalAlignment="Center"
                        Click="SearchLyricsButton_Click" />
                </StackPanel>
            </Grid>
        </Grid>
    </Grid>
</Page>
