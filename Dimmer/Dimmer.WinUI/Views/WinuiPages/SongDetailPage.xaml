<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="Dimmer.WinUI.Views.WinuiPages.SongDetailPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Dimmer.WinUI.Views.WinuiPages"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    
    xmlns:CustomViews="using:Dimmer.WinUI.Views.CustomViews.WinuiViews"
        xmlns:converters="using:Dimmer.WinUI.Utils.Converters"
    xmlns:cw="using:Dimmer.WinUI.Views.WinuiPages"
    xmlns:dgView="using:WinUI.TableView"
    xmlns:dimmSearch="clr-namespace:Dimmer.Data.ModelView.DimmerSearch;assembly=Dimmer"
    xmlns:lang="clr-namespace:Dimmer.Resources.Localization;assembly=Dimmer"
    xmlns:models="clr-namespace:Dimmer.Data.ModelView;assembly=Dimmer"
    xmlns:modelsDb="clr-namespace:Dimmer.Data.Models;assembly=Dimmer"
    xmlns:modeltwo="clr-namespace:Dimmer.WinUI.Utils.Models"
    xmlns:queryBuilder="queries"
    xmlns:tql="clr-namespace:Dimmer.DimmerSearch.TQL;assembly=Dimmer"
    xmlns:vm="clr-namespace:Dimmer.WinUI.ViewModel"
    x:Name="MyPage"
    Loaded="MyPage_Loaded"
    mc:Ignorable="d">
    <Page.Resources>

        <converters:CollectionSizeToVisibility x:Key="CollectionSizeToVisibility" />
        <converters:VolumeToPercentConverter x:Key="VolumeToPercentConverter" />
        <converters:BoolToImageConverter
            x:Key="PlayPauseConverter"
            FalseValue="play.png"
            TrueValue="pause.png" />
        <converters:BoolToImageConverter
            x:Key="FavIconConverter"
            FalseValue="heartbroken.png"
            TrueValue="heartlock.png" />
    </Page.Resources>


    <Grid>
        
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <Border Background="#111" Grid.Row="0" Height="50" VerticalAlignment="Top">
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="12">
                    <TextBlock x:Name="CurrentSectionLabel"
                           Text="Overview"
                           FontSize="18"
                           FontWeight="SemiBold"/>
                </StackPanel>
            </Border>
            <!--  Main content area  -->
            <ScrollViewer VerticalScrollBarVisibility="Auto" 
                      Margin="0,50,0,0" x:Name="Scroller"
                          
                          ViewChanged="ScrollViewer_ViewChanged"
                          Grid.Row="1" Background="Transparent">
                <StackPanel
            Padding="24" x:Name="SegmentStack"
            Orientation="Vertical"
            Spacing="20" >

                    <!--  The elements involved in the animation  -->

                    <Grid ColumnSpacing="10" x:Name="SectionOverview">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />

                        </Grid.ColumnDefinitions>

                        <!--  The Image that will be the target of the connected animation  -->

                        <Image
                    x:Name="detailedImage"
                    Grid.Column="0" 
                    Width="300"
                    Height="300"
                    Source="{x:Bind DetailedSong.CoverImagePath}" />

                        <Border Grid.Column="1">

                            <StackPanel
                        x:Name="coordinatedPanel"
                        
                        Spacing="5"
                        HorizontalAlignment="Left"
                        >

                                <TextBlock
                                HorizontalAlignment="Center"
                                Style="{ThemeResource TitleTextBlockStyle}"
                                Text="{x:Bind DetailedSong.Title,Mode=OneWay}" FontSize="80" 
                                TextWrapping="Wrap" />

                                <Button
                                HorizontalAlignment="Left"                                                
                                Content="{x:Bind DetailedSong.ArtistName,Mode=OneWay}" 
                                BorderThickness="2" FontWeight="Bold"
                            Click="ArtistBtn_Click" x:Name="ArtistBtn"
                                Background="Transparent"/>
                                <StackPanel Orientation="Horizontal" Spacing="10" Margin="0,10,0,0"
                                    >

                                    <Button
                                HorizontalAlignment="Left" 
                                
                                Content="{x:Bind DetailedSong.AlbumName,Mode=OneWay}"
                                BorderThickness="2"
                            Background="Transparent"/>
                                    <TextBlock Text="{x:Bind DetailedSong.ReleaseYear,Mode=OneWay}"
                                       VerticalAlignment="Center"/>


                                </StackPanel>

                                <TextBlock Text="{x:Bind MyViewModel.SelectedSongLastFMData.Wiki.Summary,Mode=OneWay}"/>
                            </StackPanel>

                        </Border>
                    </Grid>

                    <StackPanel x:Name="SectionPlayback" Height="400" Background="LightGray">

                        <ItemsRepeater>
                            <ItemsRepeater.Layout>
                                <UniformGridLayout MaximumRowsOrColumns="3" />
                            </ItemsRepeater.Layout>

                            <ItemsRepeater.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="White"
                                        BorderBrush="Black"
                                        BorderThickness="1"
                                        Margin="6"
                                        Padding="12">

                                        <StackPanel>
                                            
                                        <TextBlock Text="Item" Foreground="Black"/>

                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ItemsRepeater.ItemTemplate>
                        </ItemsRepeater>

                    </StackPanel>

                    <!-- SECTION 3: LYRICS -->
                    <StackPanel x:Name="SectionLyrics" Height="1" Visibility="Collapsed" Background="WhiteSmoke">
                        <TextBlock Margin="20" Text="Lyrics Section" FontSize="24"/>
                        <TextBlock Margin="20" Text="{x:Bind MyViewModel.SelectedSong.SyncLyrics}" FontSize="24"/>
                        
                    </StackPanel>

                    <!-- SECTION 4: ANALYTICS -->
                    <StackPanel x:Name="SectionAnalytics" Background="Gainsboro">
                        <TextBlock Margin="20" Text="Analytics Section" FontSize="24"/>
                        <Button x:Name="ManualFavoriteCount" Content="{x:Bind MyViewModel.SelectedSong.ManualFavoriteCount}"/>
                        <Button x:Name="PlayCompletedCount" Content="{x:Bind MyViewModel.SelectedSong.PlayCompletedCount}"/>
                        <Button x:Name="PlayCount" Content="{x:Bind MyViewModel.SelectedSong.PlayCount}"/>
                        <Button x:Name="PlayEventsCount" Content="{x:Bind MyViewModel.SelectedSong.PlayEvents.Count}"/>
                        <Button x:Name="ListenThroughRate" Content="{x:Bind MyViewModel.SelectedSong.ListenThroughRate}"/>
                        <Button x:Name="PlayStreakDays" Content="{x:Bind MyViewModel.SelectedSong.PlayStreakDays}"/>
                        <Button x:Name="PreviousCount" Content="{x:Bind MyViewModel.SelectedSong.PreviousCount}"/>
                        <Button x:Name="RankInAlbum" Content="{x:Bind MyViewModel.SelectedSong.RankInAlbum}"/>
                        <Button x:Name="RankInArtist" Content="{x:Bind MyViewModel.SelectedSong.RankInArtist}"/>
                        <Button x:Name="RepeatCount" Content="{x:Bind MyViewModel.SelectedSong.RepeatCount}"/>
                        <Button x:Name="RestartCount" Content="{x:Bind MyViewModel.SelectedSong.RestartCount}"/>
                        <Button x:Name="ResumeCount" Content="{x:Bind MyViewModel.SelectedSong.ResumeCount}"/>
                        <Button x:Name="SeekCount" Content="{x:Bind MyViewModel.SelectedSong.SeekCount}"/>
                        <Button x:Name="SkipCount" Content="{x:Bind MyViewModel.SelectedSong.SkipCount}"/>
                        <Button x:Name="SkipRate" Content="{x:Bind MyViewModel.SelectedSong.SkipRate}"/>
                        <Button x:Name="Rating" Content="{x:Bind MyViewModel.SelectedSong.Rating}"/>
                    </StackPanel>

                    <!-- SECTION 5: HISTORY -->
                    <StackPanel x:Name="SectionHistory" Height="400" Background="WhiteSmoke">
                        <TextBlock Margin="20" Text="History Section" FontSize="24"/>
                        <ItemsRepeater ItemsSource="{x:Bind DetailedSong.PlayEvents}">
                            <ItemsRepeater.ItemTemplate>
                                <DataTemplate>
                                    <Border>
                                        <StackPanel>
                                            <TextBlock Text="{Binding PlayTypeStr}"/>
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>


                            </ItemsRepeater.ItemTemplate>
                        </ItemsRepeater>
                    </StackPanel>

                    <!-- SECTION 6: RELATED -->
                    <StackPanel x:Name="SectionRelated" Height="400" Background="LightGray">
                        <TextBlock Margin="20" Text="Related Section" FontSize="24"/>
                        <StackPanel Orientation="Horizontal">

                            <TextBlock Margin="20" Text="{x:Bind MyViewModel.SelectedSongLastFMData.Statistics.Listeners}" FontSize="24"/>
                            <TextBlock Margin="20" Text="Listeners"
                                       ToolTipService.ToolTip="Total LastFM Listeners"
                                       FontSize="24"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">

                            <TextBlock Margin="20" Text="{x:Bind MyViewModel.SelectedSongLastFMData.Statistics.PlayCount}" FontSize="24"/>
                            <TextBlock Margin="20" Text="Dimms"
                                       ToolTipService.ToolTip="Total LastFM Scrobbles"
                                       FontSize="24"/>
                        </StackPanel>
                    </StackPanel>

                </StackPanel>
            </ScrollViewer>

        </Grid>
    </Grid>
</Page>