<?xml version="1.0" encoding="utf-8" ?>
<Page
    x:Class="Dimmer.WinUI.Views.WinuiPages.DimmerLive.LoginPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="using:Dimmer.WinUI.Views.WinuiPages.DimmerLive"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid>
        <Grid.Background>
            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                <GradientStop Offset="0.0" Color="#FF1E1E1E" />
                <GradientStop Offset="1.0" Color="#FF2D2D30" />
            </LinearGradientBrush>
        </Grid.Background>

        <StackPanel
            Width="360"
            HorizontalAlignment="Center"
            VerticalAlignment="Center"
            Spacing="16">

            <TextBlock
                HorizontalAlignment="Center"
                FontSize="32"
                FontWeight="Bold"
                Text="Dimmer" />
            <TextBlock
                Margin="0,0,0,20"
                HorizontalAlignment="Center"
                FontSize="16"
                Opacity="0.7"
                Text="Sync. Chat. Listen." />

            <!--  Error Banner  -->
            <InfoBar
                IsOpen="{x:Bind ViewModel.ErrorMessage, Mode=OneWay, Converter={StaticResource StringToBoolConverter}}"
                Message="{x:Bind ViewModel.ErrorMessage, Mode=OneWay}"
                Severity="Error" />

            <!--  Login Form  -->
            <StackPanel Spacing="12" Visibility="{x:Bind ViewModel.IsRegisterMode, Mode=OneWay, Converter={StaticResource InvBoolToVis}}">
                <TextBox Header="Username" Text="{x:Bind ViewModel.Username, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                <PasswordBox Header="Password" Password="{x:Bind ViewModel.Password, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                <Button
                    HorizontalAlignment="Stretch"
                    Command="{x:Bind ViewModel.LoginCommand}"
                    Content="Log In"
                    IsEnabled="{x:Bind ViewModel.IsBusy, Converter={StaticResource BoolToInverseConverter}, Mode=OneWay}"
                    Style="{StaticResource AccentButtonStyle}"
                    Visibility="{x:Bind ViewModel.IsBusy, Mode=OneWay, Converter={StaticResource InvBoolToVis}}" />
            </StackPanel>

            <!--  Register Form  -->
            <StackPanel Spacing="12" Visibility="{x:Bind ViewModel.IsRegisterMode, Mode=OneWay, Converter={StaticResource BoolToVis}}">
                <TextBox Header="Username" Text="{x:Bind ViewModel.Username, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                <TextBox Header="Email" Text="{x:Bind ViewModel.Email, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                <PasswordBox Header="Password" Password="{x:Bind ViewModel.Password, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                <Button
                    HorizontalAlignment="Stretch"
                    Command="{x:Bind ViewModel.RegisterCommand}"
                    Content="Sign Up"
                    IsEnabled="{x:Bind ViewModel.IsBusy, Converter={StaticResource BoolToInverseConverter}, Mode=OneWay}"
                    Style="{StaticResource AccentButtonStyle}"
                    Visibility="{x:Bind ViewModel.IsBusy, Mode=OneWay, Converter={StaticResource InvBoolToVis}}" />
            </StackPanel>

            <!--  Toggle Mode  -->
            <StackPanel
                Margin="0,10,0,0"
                HorizontalAlignment="Center"
                Orientation="Horizontal">
                <TextBlock
                    VerticalAlignment="Center"
                    Opacity="0.7"
                    Text="{x:Bind ViewModel.ToggleText, Mode=OneWay}" />
                <HyperlinkButton Command="{x:Bind ViewModel.ToggleModeCommand}" Content="{x:Bind ViewModel.ToggleLinkText, Mode=OneWay}" />
            </StackPanel>

            <ProgressRing Margin="0,10,0,0" IsActive="{x:Bind ViewModel.IsBusy, Mode=OneWay}" />

        </StackPanel>
    </Grid>
</Page>