<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="Dimmer.WinUI.Views.DimmerLiveUI.SessionTransferView"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:behv="clr-namespace:CommunityToolkit.WinUI.Behaviors;assembly=CommunityToolkit.WinUI.Behaviors"
    xmlns:chart="http://schemas.syncfusion.com/maui/toolkit"
    xmlns:converters="clr-namespace:Dimmer.Utilities.TypeConverters;assembly=Dimmer"
    xmlns:cw="clr-namespace:Dimmer.WinUI.Views.CustomViews"
    xmlns:device="clr-namespace:Microsoft.Maui.Devices;assembly=Microsoft.Maui.Essentials"
    xmlns:dimmSearch="clr-namespace:Dimmer.Data.ModelView.DimmerSearch;assembly=Dimmer"
    xmlns:lang="clr-namespace:Dimmer.Resources.Localization;assembly=Dimmer"
    xmlns:material="http://schemas.enisn-projects.io/dotnet/maui/uraniumui/material"
    xmlns:modelOnline="clr-namespace:Dimmer.DimmerLive.Models;assembly=Dimmer"
    xmlns:models="clr-namespace:Dimmer.Data.ModelView;assembly=Dimmer"
    xmlns:modelsDb="clr-namespace:Dimmer.Data.Models;assembly=Dimmer"
    xmlns:modeltwo="clr-namespace:Dimmer.WinUI.Utils.Models"
    xmlns:syncf="http://schemas.syncfusion.com/maui/toolkit"
    xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
    xmlns:tql="clr-namespace:Dimmer.DimmerSearch.TQL;assembly=Dimmer"
    xmlns:uranium="http://schemas.enisn-projects.io/dotnet/maui/uraniumui"
    xmlns:vm="clr-namespace:Dimmer.WinUI.ViewModel"
    xmlns:windows="clr-namespace:Microsoft.Maui.Controls.PlatformConfiguration.WindowsSpecific;assembly=Microsoft.Maui.Controls"
    x:Name="myPage"
    Title="SessionTransferView"
    x:DataType="vm:SessionTransferVMWin"
    BackgroundColor="{AppThemeBinding Light=#F5F5F5,
                                      Dark=#1F1F1F}"
    Shell.NavBarIsVisible="False">

    <ContentPage.Resources>
        <converters:DurationConverterFromMsToTimeSpan x:Key="DurationConverter" />
        <converters:BytesToMegabytesConverter x:Key="FileSizeConverter" />
        <converters:BytesArrayToImageSource x:Key="BytesToImageConverter" />
        <converters:BoolToInverseConverter x:Key="BoolToInverse" />
        <converters:IndexToVisibilityConverter x:Key="IndexToVisibilityConverter" />
        <converters:DateTimeToLocalDateConverter x:Key="DateTimeConverter" />
        <converters:DateTimeToLocalTimeConverter x:Key="DateTimeToTimeConverter" />
        <converters:BoolToYesNoConverter x:Key="BoolToYesNo" />
        <converters:VolumeConverter x:Key="VolConverter" />

    </ContentPage.Resources>
    <syncf:SfTabView x:Name="MainView" EnableSwiping="True">
        <syncf:SfTabItem>
            <syncf:SfTabItem.Content>

                <VerticalStackLayout
                    x:Name="TransferView"
                    Padding="20"
                    Spacing="10">
                    <Label
                        FontSize="Header"
                        HorizontalOptions="Center"
                        Text="Transfer Playback" />
                    <Label HorizontalOptions="Center" Text="{Binding StatusMessage}" />
                    <ActivityIndicator IsRunning="{Binding IsTransferInProgress}" />

                    <Label
                        Margin="0,20,0,0"
                        FontAttributes="Bold"
                        Text="Available Devices:" />
                    <CollectionView ItemsSource="{Binding OtherDevices}">
                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="{x:Type modelOnline:UserDeviceSession}">
                                <Grid Padding="10" ColumnDefinitions="*, Auto">
                                    <VerticalStackLayout>
                                        <Label FontAttributes="Bold" Text="{Binding DeviceName}" />
                                        <Label FontSize="Small" Text="{Binding DeviceIdiom}" />
                                    </VerticalStackLayout>
                                    <Button
                                        Grid.Column="1"
                                        Command="{Binding Source={RelativeSource AncestorType={x:Type vm:SocialViewModelWin}}, Path=TransferToDeviceCommand}"
                                        CommandParameter="{Binding .}"
                                        Text="Transfer Here" />
                                </Grid>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>


            </syncf:SfTabItem.Content>
        </syncf:SfTabItem>

        <syncf:SfTabItem>
            <syncf:SfTabItem.Content>

                <Border x:Name="LoginSignUp" StyleClass="Elevation2">

                    <VerticalStackLayout HorizontalOptions="Center" Spacing="10">
                        <Label
                            FontSize="24"
                            HorizontalOptions="Center"
                            Text="Login" />
                        <Label x:Name="Uname" Text="{Binding LoginViewModel.CurrentUser.Username}" />
                        <Label x:Name="UEmail" Text="{Binding LoginViewModel.CurrentUser.Email}" />
                        <Label
                            FontSize="16"
                            HorizontalOptions="Center"
                            Text="Please login to continue" />


                        <Entry
                            x:Name="UsernameEntry"
                            FontSize="16"
                            HorizontalOptions="Fill"
                            Placeholder="Enter your username"
                            Text="{Binding LoginViewModel.Username}" />
                        <Entry
                            x:Name="EmailEntry"
                            FontSize="16"
                            HorizontalOptions="Fill"
                            Placeholder="Enter your Email"
                            Text="{Binding LoginViewModel.Email}" />


                        <Entry
                            x:Name="PasswordEntry"
                            FontSize="16"
                            HorizontalOptions="Fill"
                            IsPassword="True"
                            Placeholder="Enter your password"
                            Text="{Binding LoginViewModel.Password}" />

                        <HorizontalStackLayout HorizontalOptions="Center" Spacing="10">

                            <Button
                                x:Name="Login"
                                Clicked="Login_Clicked"
                                FontSize="16"
                                HorizontalOptions="Center"
                                Text="Login" />


                            <Button
                                Command="{Binding LoginViewModel.RegisterCommand}"
                                FontSize="16"
                                HorizontalOptions="Center"
                                Text="Sign Up" />

                        </HorizontalStackLayout>



                    </VerticalStackLayout>

                </Border>
            </syncf:SfTabItem.Content>
        </syncf:SfTabItem>
    </syncf:SfTabView>
</ContentPage>