<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="Dimmer.Views.HomePage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:converters="clr-namespace:Dimmer.Utilities.TypeConverters;assembly=Dimmer"
    xmlns:customViewParts="clr-namespace:Dimmer.Views.CustomViewsParts"
    xmlns:dx="http://schemas.devexpress.com/maui"
    xmlns:helper="clr-namespace:Dimmer.Utils.AnimsStatics"
    xmlns:models="clr-namespace:Dimmer.Data.ModelView;assembly=Dimmer"
    xmlns:navDrawer="clr-namespace:Syncfusion.Maui.Toolkit.NavigationDrawer;assembly=Syncfusion.Maui.Toolkit"
    xmlns:progressBar="clr-namespace:Syncfusion.Maui.Toolkit;assembly=Syncfusion.Maui.Toolkit"
    xmlns:syncf="http://schemas.syncfusion.com/maui/toolkit"
    xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
    xmlns:viewUtils="clr-namespace:Dimmer.Utilities.ViewsUtils;assembly=Dimmer"
    xmlns:vm="clr-namespace:Dimmer.ViewModels"
    x:Name="myPage"
    Title="HomePage"
    x:DataType="vm:BaseViewModelAnd"
    x:FieldModifier="Public"
    BackgroundColor="{AppThemeBinding Light=#F5F5F5,
                                      Dark=#1E1E1E}"
    Shell.NavBarIsVisible="False"
    Shell.TabBarIsVisible="False">

    <ContentPage.Resources>
        <ResourceDictionary>




            <DataTemplate x:Key="filteringUIFormTemplate">
                <dx:DXScrollView>
                    <dx:DXStackLayout>

                        <dx:FilterChipGroupItem FieldName="FileFormat" Text="FileFormat" />
                        <dx:FilterCheckItem FieldName="IsFavorite" Text="Is Favorite?" />
                    </dx:DXStackLayout>
                </dx:DXScrollView>
            </DataTemplate>
            <Style TargetType="Label">
                <Setter Property="Text" Value="{AppThemeBinding Dark=White, Light=black}" />
                <Setter Property="VerticalOptions" Value="Center" />
                <Setter Property="FontSize" Value="26" />
            </Style>

            <Style TargetType="dx:Chip">

                <Setter Property="VerticalOptions" Value="Center" />
                <Setter Property="FontSize" Value="19" />
            </Style>

            <Style TargetType="Grid">

                <Setter Property="BackgroundColor" Value="Transparent" />

            </Style>

            <Style TargetType="dx:DXButton">

                <Setter Property="VerticalOptions" Value="Center" />
                <Setter Property="BackgroundColor" Value="Transparent" />
                <Setter Property="TextColor" Value="{AppThemeBinding Dark=White, Light=Black}" />
                <Setter Property="IconColor" Value="DarkSlateBlue" />
                <Setter Property="PressedBackgroundColor" Value="DarkSlateBlue" />
                <Setter Property="PressedIconColor" Value="{AppThemeBinding Dark=White,Light=Black}" />
            </Style>

            <Style x:Key="LittleBtn" TargetType="dx:DXButton">
                <Setter Property="IconHeight" Value="19" />
            </Style>

            <converters:DurationConverterFromMsToTimeSpan x:Key="DurationConverter" />
            <converters:BytesToMegabytesConverter x:Key="FileSizeConverter" />
            <converters:BytesArrayToImageSource x:Key="BytesToImageConverter" />
            <converters:BoolToInverseConverter x:Key="BoolToInverse" />


        </ResourceDictionary>



    </ContentPage.Resources>
    <Grid x:Name="RootLayout" Margin="0">
        <!--<dx:DXImage
            Aspect="AspectFill"
            Opacity="{AppThemeBinding Light=0,
                                      Dark=0.09}"
            Source="{Binding BaseVM.CurrentPlayingSongView.CoverImageBytes, Converter={converters:BytesArrayToImageSource}}" />-->

        <dx:SafeKeyboardAreaView
            x:Name="myPageSKAV"
            Closed="myPageSKAV_Closed"
            FitKeyboardAreaToContent="SizeToContent"
            IsVisible="True">
            <dx:DXDockLayout x:Name="HomeView" BackgroundColor="Transparent">

                
                <!--<dx:DXScrollView x:Name="MainPageScrollView">-->

                <Grid
                    x:Name="SearchContentView"
                    x:DataType="vm:BaseViewModelAnd"
                    IsVisible="True" RowSpacing="5"
                    Margin="5,0"
                    RowDefinitions="auto,auto,*,auto">
                    <dx:DXStackLayout x:Name="TopPartOfPage">
                        
                    </dx:DXStackLayout>
                    <customViewParts:MainViewExpander x:Name="MainViewExpander"/>
                    <!--<customViewParts:NowPlayingUISection x:Name="NowPlayingUISection" IsVisible="False"/>-->

                    
                    <dx:DXExpander
                        x:Name="BtmBarExp"
                        Grid.Row="3" 
                        VerticalOptions="End"
                        IsExpanded="True">

                        <Grid 
    Grid.Row="1" 
    
    ColumnDefinitions="*"
    RowDefinitions="*,auto">

                            <dx:DXExpander
        x:Name="BtmBarZone"
        Grid.Column="0"
        Grid.Row="2"
        BackgroundColor="Transparent"
        IsExpanded="True"
        VerticalOptions="End">

                                <Grid BackgroundColor="Transparent" VerticalOptions="End">

                                    <customViewParts:BtmBar
                    RequestFocusNowPlayingUI="BtmBar_RequestFocusNowPlayingUI"
                    RequestFocusOnMainView="BtmBar_RequestFocusOnMainView"
                    ScrollToStart="BtmBar_ScrollToStart" x:Name="MyBtmBar"
                    ToggleAdvanceFilters="BtmBar_ToggleAdvanceFilters" />
                                    <dx:DXStackLayout
                    x:Name="BelowBtmBar"
                    IsVisible="False"
                    ItemSpacing="5">

                                        <dx:DXStackLayout
                        x:Name="AdvfilterSection"
                        Padding="10"
                        HorizontalOptions="Center"
                        ItemSpacing="5"
                        Orientation="Horizontal">
                                            <dx:Chip BorderColor="DarkSlateBlue" Text="Advanced Filters" />
                                            <dx:Chip
                            x:Name="am"
                            BorderThickness="0"
                            DoubleTap="am_DoubleTap"
                            Icon="more1.png"
                            IconSize="40,40"
                            IsIconVisible="True" />
                                            <dx:Chip
                            x:Name="ClearSearch"
                            BorderThickness="0"
                            Icon="delete.png"
                            IconColor="DarkSlateBlue"
                            IconSize="40,40"
                            IsIconVisible="True"
                            LongPress="ClearSearch_LongPress" />
                                        </dx:DXStackLayout>
                                        <dx:DXExpander x:Name="SearchSection" IsExpanded="True">
                                            <dx:DXExpander.Content>
                                                <dx:DXStackLayout
                                x:Name="SearchFilters"
                                HorizontalOptions="Center"
                                ItemSpacing="10"
                                Orientation="Horizontal">
                                                    <dx:Chip
                                    x:Name="AddSearchFilter"
                                    Tap="AddSearchFilter_Tap"
                                    TapCommandParameter="t:"
                                    Text="title" />
                                                    <dx:Chip
                                    Tap="AddSearchFilter_Tap"
                                    TapCommandParameter="ar:"
                                    Text="artist" />
                                                    <dx:Chip
                                    Tap="AddSearchFilter_Tap"
                                    TapCommandParameter="al:"
                                    Text="album" />
                                                    <dx:Chip
                                    Tap="AddSearchFilter_Tap"
                                    TapCommandParameter="genre:"
                                    Text="genre" />
                                                    <dx:Chip
                                    Tap="AddSearchFilter_Tap"
                                    TapCommandParameter="len:"
                                    Text="duration" />


                                                </dx:DXStackLayout>
                                            </dx:DXExpander.Content>
                                        </dx:DXExpander>

                                    </dx:DXStackLayout>


                                </Grid>


                            </dx:DXExpander>
                        </Grid>

                    </dx:DXExpander>
                    <customViewParts:MoreModal x:Name="MoreModal"/>
                </Grid>
            </dx:DXDockLayout>
        </dx:SafeKeyboardAreaView>

    </Grid>

    <!--</dx:DXScrollView>-->

</ContentPage>
